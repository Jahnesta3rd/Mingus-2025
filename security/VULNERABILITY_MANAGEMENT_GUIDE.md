# Vulnerability Management System Guide

## Overview

This guide provides comprehensive vulnerability management for MINGUS, covering vulnerability scanning schedule and automated vulnerability management capabilities with multi-scanner support, scheduled scanning, and vulnerability tracking.

## ðŸ”’ **Vulnerability Management Components**

### **1. Vulnerability Management System**
- **Multi-Scanner Support**: Network, web application, container, dependency, code, infrastructure scanners
- **Scheduled Scanning**: Daily, weekly, monthly, custom, on-demand scanning schedules
- **Vulnerability Tracking**: Comprehensive vulnerability tracking and remediation management
- **Scan History**: Complete scan history and results tracking
- **Automated Scanning**: Automated vulnerability scanning based on schedules

### **2. Vulnerability Scanners**
- **Nmap Scanner**: Network vulnerability scanning with vulners script
- **Dependency Scanner**: Python and Node.js dependency vulnerability scanning
- **Web Application Scanner**: Web application vulnerability scanning with OWASP ZAP
- **Container Scanner**: Container image vulnerability scanning
- **Code Scanner**: Static code analysis for vulnerabilities
- **Infrastructure Scanner**: Infrastructure vulnerability scanning

### **3. Vulnerability Scanning Schedule**
- **Schedule Types**: Daily, weekly, monthly, custom, on-demand schedules
- **Schedule Management**: Create, update, enable/disable schedules
- **Automated Execution**: Automated schedule execution with background scheduler
- **Schedule Monitoring**: Monitor schedule execution and results
- **Flexible Configuration**: Configurable scan targets, types, and parameters

### **4. Vulnerability Tracking**
- **Vulnerability Database**: Comprehensive vulnerability database with metadata
- **Severity Classification**: Critical, high, medium, low, info severity levels
- **Remediation Tracking**: Track vulnerability remediation status and progress
- **Risk Scoring**: Calculate and track vulnerability risk scores
- **False Positive Management**: Mark and manage false positive vulnerabilities

### **5. Scan Types Supported**
- **Network Scans**: Network infrastructure vulnerability scanning
- **Web Application Scans**: Web application vulnerability scanning
- **Container Scans**: Container image vulnerability scanning
- **Dependency Scans**: Software dependency vulnerability scanning
- **Code Scans**: Static code analysis for vulnerabilities
- **Infrastructure Scans**: Infrastructure vulnerability scanning
- **Comprehensive Scans**: Full system vulnerability scanning

### **6. Schedule Types**
- **Daily Schedules**: Daily vulnerability scanning
- **Weekly Schedules**: Weekly vulnerability scanning
- **Monthly Schedules**: Monthly vulnerability scanning
- **Custom Schedules**: Custom interval vulnerability scanning
- **On-Demand Schedules**: Manual vulnerability scanning

## ðŸš€ **Usage**

### **Create Vulnerability Management System**
```python
from security.vulnerability_management import create_vulnerability_management_system, ScanType, ScheduleType

# Create vulnerability management system
vuln_system = create_vulnerability_management_system(base_url="http://localhost:5000")

# Create vulnerability scan
scan = vuln_system.create_vulnerability_scan(
    scan_type=ScanType.NETWORK,
    targets=["192.168.1.0/24", "10.0.0.0/8"],
    target_services=["ssh", "http", "https", "database"],
    scan_configuration={
        "scan_args": "-sV --script vuln",
        "timeout": 3600,
        "parallel_scans": 5
    },
    created_by="security-team"
)

print(f"Scan created: {scan.scan_id}")
print(f"Scan type: {scan.scan_type.value}")
print(f"Targets: {scan.target_systems}")
print(f"Status: {scan.status.value}")
```

### **Execute Vulnerability Scan**
```python
from security.vulnerability_management import create_vulnerability_management_system, ScanType

# Create vulnerability management system
vuln_system = create_vulnerability_management_system(base_url="http://localhost:5000")

# Create and execute vulnerability scan
scan = vuln_system.create_vulnerability_scan(
    scan_type=ScanType.NETWORK,
    targets=["192.168.1.1", "192.168.1.2", "192.168.1.3"],
    scan_configuration={
        "scan_args": "-sV --script vuln",
        "timeout": 1800
    },
    created_by="security-team"
)

# Execute scan
success = vuln_system.execute_scan(scan)

if success:
    print(f"Scan executed successfully: {scan.scan_id}")
    print(f"Duration: {scan.duration} seconds")
    print(f"Vulnerabilities found: {scan.vulnerabilities_found}")
    print(f"Critical: {scan.critical_vulnerabilities}")
    print(f"High: {scan.high_vulnerabilities}")
    print(f"Medium: {scan.medium_vulnerabilities}")
    print(f"Low: {scan.low_vulnerabilities}")
else:
    print("Scan execution failed")
    print(f"Error: {scan.error_message}")
```

### **Create Vulnerability Scan Schedule**
```python
from security.vulnerability_management import create_vulnerability_management_system, ScanType, ScheduleType

# Create vulnerability management system
vuln_system = create_vulnerability_management_system(base_url="http://localhost:5000")

# Create daily network scan schedule
daily_network_schedule = vuln_system.create_vulnerability_schedule(
    name="Daily Network Vulnerability Scan",
    description="Daily network vulnerability scan for critical infrastructure",
    scan_type=ScanType.NETWORK,
    schedule_type=ScheduleType.DAILY,
    targets=["192.168.1.0/24", "10.0.0.0/8"],
    target_services=["ssh", "http", "https", "database"],
    scan_configuration={
        "scan_args": "-sV --script vuln",
        "timeout": 3600,
        "parallel_scans": 5
    },
    enabled=True,
    created_by="security-team"
)

print(f"Schedule created: {daily_network_schedule.schedule_id}")
print(f"Name: {daily_network_schedule.name}")
print(f"Scan type: {daily_network_schedule.scan_type.value}")
print(f"Schedule type: {daily_network_schedule.schedule_type.value}")
print(f"Next run: {daily_network_schedule.next_run}")
print(f"Enabled: {daily_network_schedule.enabled}")
```

### **Create Weekly Web Application Scan Schedule**
```python
from security.vulnerability_management import create_vulnerability_management_system, ScanType, ScheduleType

# Create vulnerability management system
vuln_system = create_vulnerability_management_system(base_url="http://localhost:5000")

# Create weekly web application scan schedule
weekly_web_schedule = vuln_system.create_vulnerability_schedule(
    name="Weekly Web Application Vulnerability Scan",
    description="Weekly web application vulnerability scan for production applications",
    scan_type=ScanType.WEB_APPLICATION,
    schedule_type=ScheduleType.WEEKLY,
    targets=["https://app1.company.com", "https://app2.company.com", "https://api.company.com"],
    target_services=["web_application"],
    scan_configuration={
        "scan_level": "medium",
        "timeout": 7200,
        "crawl_depth": 5,
        "scan_rules": ["sql_injection", "xss", "csrf", "authentication"]
    },
    enabled=True,
    created_by="security-team"
)

print(f"Schedule created: {weekly_web_schedule.schedule_id}")
print(f"Name: {weekly_web_schedule.name}")
print(f"Scan type: {weekly_web_schedule.scan_type.value}")
print(f"Schedule type: {weekly_web_schedule.schedule_type.value}")
print(f"Next run: {weekly_web_schedule.next_run}")
print(f"Targets: {weekly_web_schedule.target_systems}")
```

### **Create Monthly Dependency Scan Schedule**
```python
from security.vulnerability_management import create_vulnerability_management_system, ScanType, ScheduleType

# Create vulnerability management system
vuln_system = create_vulnerability_management_system(base_url="http://localhost:5000")

# Create monthly dependency scan schedule
monthly_dep_schedule = vuln_system.create_vulnerability_schedule(
    name="Monthly Dependency Vulnerability Scan",
    description="Monthly dependency vulnerability scan for all projects",
    scan_type=ScanType.DEPENDENCY,
    schedule_type=ScheduleType.MONTHLY,
    targets=[
        "/var/www/project1",
        "/var/www/project2",
        "/var/www/project3",
        "/opt/applications/project4"
    ],
    target_services=["python", "nodejs", "java", "ruby"],
    scan_configuration={
        "scan_python": True,
        "scan_nodejs": True,
        "scan_java": True,
        "scan_ruby": True,
        "update_database": True,
        "timeout": 1800
    },
    enabled=True,
    created_by="security-team"
)

print(f"Schedule created: {monthly_dep_schedule.schedule_id}")
print(f"Name: {monthly_dep_schedule.name}")
print(f"Scan type: {monthly_dep_schedule.scan_type.value}")
print(f"Schedule type: {monthly_dep_schedule.schedule_type.value}")
print(f"Next run: {monthly_dep_schedule.next_run}")
print(f"Targets: {monthly_dep_schedule.target_systems}")
```

### **Create Custom Scan Schedule**
```python
from security.vulnerability_management import create_vulnerability_management_system, ScanType, ScheduleType

# Create vulnerability management system
vuln_system = create_vulnerability_management_system(base_url="http://localhost:5000")

# Create custom scan schedule (every 6 hours)
custom_schedule = vuln_system.create_vulnerability_schedule(
    name="Critical Infrastructure Scan",
    description="Critical infrastructure vulnerability scan every 6 hours",
    scan_type=ScanType.COMPREHENSIVE,
    schedule_type=ScheduleType.CUSTOM,
    targets=["192.168.1.1", "192.168.1.2", "10.0.0.1"],
    target_services=["all"],
    schedule_config={
        "interval_hours": 6,
        "start_time": "00:00",
        "end_time": "23:59"
    },
    scan_configuration={
        "scan_network": True,
        "scan_web": True,
        "scan_dependencies": True,
        "scan_containers": True,
        "timeout": 5400,
        "parallel_scans": 3
    },
    enabled=True,
    created_by="security-team"
)

print(f"Schedule created: {custom_schedule.schedule_id}")
print(f"Name: {custom_schedule.name}")
print(f"Scan type: {custom_schedule.scan_type.value}")
print(f"Schedule type: {custom_schedule.schedule_type.value}")
print(f"Interval: {custom_schedule.schedule_config.get('interval_hours')} hours")
print(f"Next run: {custom_schedule.next_run}")
```

### **Get Vulnerability Information**
```python
from security.vulnerability_management import create_vulnerability_management_system

# Create vulnerability management system
vuln_system = create_vulnerability_management_system(base_url="http://localhost:5000")

# Get all vulnerabilities
all_vulnerabilities = vuln_system.get_vulnerabilities()

print(f"Total vulnerabilities: {len(all_vulnerabilities)}")

# Get critical vulnerabilities
critical_vulnerabilities = vuln_system.get_vulnerabilities(filters={"severity": "critical"})

print(f"Critical vulnerabilities: {len(critical_vulnerabilities)}")

for vuln in critical_vulnerabilities:
    print(f"  {vuln.vulnerability_id}: {vuln.title}")
    print(f"    CVSS Score: {vuln.cvss_score}")
    print(f"    Status: {vuln.remediation_status}")
    print(f"    Affected Systems: {vuln.affected_systems}")

# Get open vulnerabilities
open_vulnerabilities = vuln_system.get_vulnerabilities(filters={"status": "open"})

print(f"Open vulnerabilities: {len(open_vulnerabilities)}")

# Get vulnerabilities for specific system
system_vulnerabilities = vuln_system.get_vulnerabilities(filters={"system": "192.168.1.1"})

print(f"Vulnerabilities for 192.168.1.1: {len(system_vulnerabilities)}")
```

### **Get Scan History**
```python
from security.vulnerability_management import create_vulnerability_management_system
from datetime import datetime, timedelta

# Create vulnerability management system
vuln_system = create_vulnerability_management_system(base_url="http://localhost:5000")

# Get all scan history
all_scans = vuln_system.get_scan_history()

print(f"Total scans: {len(all_scans)}")

# Get recent scans (last 7 days)
recent_scans = vuln_system.get_scan_history(filters={
    "date_from": datetime.utcnow() - timedelta(days=7)
})

print(f"Recent scans (last 7 days): {len(recent_scans)}")

for scan in recent_scans[:5]:  # Show last 5 scans
    print(f"  {scan.scan_id}: {scan.scan_type.value}")
    print(f"    Status: {scan.status.value}")
    print(f"    Created: {scan.created_at}")
    print(f"    Vulnerabilities: {scan.vulnerabilities_found}")
    print(f"    Duration: {scan.duration} seconds")

# Get completed scans
completed_scans = vuln_system.get_scan_history(filters={"status": "completed"})

print(f"Completed scans: {len(completed_scans)}")

# Get network scans
network_scans = vuln_system.get_scan_history(filters={"scan_type": "network"})

print(f"Network scans: {len(network_scans)}")
```

### **Update Vulnerability Status**
```python
from security.vulnerability_management import create_vulnerability_management_system
from datetime import datetime, timedelta

# Create vulnerability management system
vuln_system = create_vulnerability_management_system(base_url="http://localhost:5000")

# Get open vulnerabilities
open_vulnerabilities = vuln_system.get_vulnerabilities(filters={"status": "open"})

if open_vulnerabilities:
    # Update first vulnerability status
    vuln = open_vulnerabilities[0]
    
    success = vuln_system.update_vulnerability_status(
        vulnerability_id=vuln.vulnerability_id,
        status="in_progress",
        priority="high",
        notes="Working on remediation plan",
        deadline=datetime.utcnow() + timedelta(days=7)
    )
    
    if success:
        print(f"Vulnerability status updated: {vuln.vulnerability_id}")
        print(f"New status: in_progress")
        print(f"Priority: high")
        print(f"Deadline: {datetime.utcnow() + timedelta(days=7)}")
    else:
        print("Failed to update vulnerability status")
else:
    print("No open vulnerabilities found")
```

## ðŸ”§ **Command Line Usage**

### **Create Vulnerability Scan**
```bash
# Create network vulnerability scan
python security/vulnerability_management.py \
    --create-scan \
    --scan-type "network" \
    --targets "192.168.1.0/24" "10.0.0.0/8" \
    --base-url http://localhost:5000

# Example output:
# Creating vulnerability scan...
# Scan created: scan-network-1703123456
# Scan type: network
# Targets: ['192.168.1.0/24', '10.0.0.0/8']
# Status: scheduled
```

### **Create Vulnerability Schedule**
```bash
# Create daily vulnerability schedule
python security/vulnerability_management.py \
    --create-schedule \
    --scan-type "network" \
    --schedule-type "daily" \
    --schedule-name "Daily Network Scan" \
    --targets "192.168.1.0/24" \
    --base-url http://localhost:5000

# Example output:
# Creating vulnerability schedule...
# Schedule created: schedule-network-1703123456
# Name: Daily Network Scan
# Scan type: network
# Schedule type: daily
# Next run: 2024-01-16 00:00:00
```

### **Execute Vulnerability Scan**
```bash
# Execute vulnerability scan
python security/vulnerability_management.py \
    --execute-scan \
    --scan-type "network" \
    --targets "192.168.1.1" "192.168.1.2" \
    --base-url http://localhost:5000

# Example output:
# Executing vulnerability scan...
# Scan executed successfully: scan-network-1703123456
# Vulnerabilities found: 5
# Critical: 1
# High: 2
# Medium: 1
# Low: 1
```

## ðŸ“Š **Vulnerability Management Examples**

### **Comprehensive Vulnerability Management Example**
```python
from security.vulnerability_management import create_vulnerability_management_system, ScanType, ScheduleType

# Create vulnerability management system
vuln_system = create_vulnerability_management_system(base_url="http://localhost:5000")

# Example comprehensive vulnerability management
def comprehensive_vulnerability_management_example():
    """Comprehensive vulnerability management example"""
    try:
        print("Starting comprehensive vulnerability management...")
        
        # Step 1: Create various scan schedules
        print("\nStep 1: Creating vulnerability scan schedules...")
        
        # Daily network scan
        daily_network = vuln_system.create_vulnerability_schedule(
            name="Daily Network Vulnerability Scan",
            description="Daily network vulnerability scan for critical infrastructure",
            scan_type=ScanType.NETWORK,
            schedule_type=ScheduleType.DAILY,
            targets=["192.168.1.0/24", "10.0.0.0/8"],
            scan_configuration={
                "scan_args": "-sV --script vuln",
                "timeout": 3600
            },
            enabled=True,
            created_by="security-team"
        )
        
        if daily_network:
            print(f"  âœ“ Daily network schedule created: {daily_network.schedule_id}")
        
        # Weekly web application scan
        weekly_web = vuln_system.create_vulnerability_schedule(
            name="Weekly Web Application Vulnerability Scan",
            description="Weekly web application vulnerability scan for production applications",
            scan_type=ScanType.WEB_APPLICATION,
            schedule_type=ScheduleType.WEEKLY,
            targets=["https://app1.company.com", "https://app2.company.com"],
            scan_configuration={
                "scan_level": "medium",
                "timeout": 7200
            },
            enabled=True,
            created_by="security-team"
        )
        
        if weekly_web:
            print(f"  âœ“ Weekly web schedule created: {weekly_web.schedule_id}")
        
        # Monthly dependency scan
        monthly_dep = vuln_system.create_vulnerability_schedule(
            name="Monthly Dependency Vulnerability Scan",
            description="Monthly dependency vulnerability scan for all projects",
            scan_type=ScanType.DEPENDENCY,
            schedule_type=ScheduleType.MONTHLY,
            targets=["/var/www/project1", "/var/www/project2"],
            scan_configuration={
                "scan_python": True,
                "scan_nodejs": True,
                "timeout": 1800
            },
            enabled=True,
            created_by="security-team"
        )
        
        if monthly_dep:
            print(f"  âœ“ Monthly dependency schedule created: {monthly_dep.schedule_id}")
        
        # Step 2: Execute immediate scans
        print("\nStep 2: Executing immediate vulnerability scans...")
        
        # Network scan
        network_scan = vuln_system.create_vulnerability_scan(
            scan_type=ScanType.NETWORK,
            targets=["192.168.1.1", "192.168.1.2"],
            scan_configuration={
                "scan_args": "-sV --script vuln",
                "timeout": 1800
            },
            created_by="security-team"
        )
        
        if network_scan:
            print(f"  Executing network scan: {network_scan.scan_id}")
            network_success = vuln_system.execute_scan(network_scan)
            
            if network_success:
                print(f"    âœ“ Network scan completed")
                print(f"    Vulnerabilities found: {network_scan.vulnerabilities_found}")
                print(f"    Critical: {network_scan.critical_vulnerabilities}")
                print(f"    High: {network_scan.high_vulnerabilities}")
            else:
                print(f"    âœ— Network scan failed")
        
        # Dependency scan
        dep_scan = vuln_system.create_vulnerability_scan(
            scan_type=ScanType.DEPENDENCY,
            targets=["/var/www/project1"],
            scan_configuration={
                "scan_python": True,
                "scan_nodejs": True,
                "timeout": 900
            },
            created_by="security-team"
        )
        
        if dep_scan:
            print(f"  Executing dependency scan: {dep_scan.scan_id}")
            dep_success = vuln_system.execute_scan(dep_scan)
            
            if dep_success:
                print(f"    âœ“ Dependency scan completed")
                print(f"    Vulnerabilities found: {dep_scan.vulnerabilities_found}")
                print(f"    Critical: {dep_scan.critical_vulnerabilities}")
                print(f"    High: {dep_scan.high_vulnerabilities}")
            else:
                print(f"    âœ— Dependency scan failed")
        
        # Step 3: Get vulnerability information
        print("\nStep 3: Getting vulnerability information...")
        
        # Get all vulnerabilities
        all_vulnerabilities = vuln_system.get_vulnerabilities()
        print(f"  Total vulnerabilities: {len(all_vulnerabilities)}")
        
        # Get critical vulnerabilities
        critical_vulnerabilities = vuln_system.get_vulnerabilities(filters={"severity": "critical"})
        print(f"  Critical vulnerabilities: {len(critical_vulnerabilities)}")
        
        # Get open vulnerabilities
        open_vulnerabilities = vuln_system.get_vulnerabilities(filters={"status": "open"})
        print(f"  Open vulnerabilities: {len(open_vulnerabilities)}")
        
        # Step 4: Get scan history
        print("\nStep 4: Getting scan history...")
        
        # Get all scans
        all_scans = vuln_system.get_scan_history()
        print(f"  Total scans: {len(all_scans)}")
        
        # Get completed scans
        completed_scans = vuln_system.get_scan_history(filters={"status": "completed"})
        print(f"  Completed scans: {len(completed_scans)}")
        
        # Step 5: Get schedules
        print("\nStep 5: Getting vulnerability schedules...")
        
        schedules = vuln_system.get_schedules()
        print(f"  Total schedules: {len(schedules)}")
        
        for schedule in schedules:
            print(f"    {schedule.name}: {schedule.schedule_type.value} {schedule.scan_type.value}")
            print(f"      Next run: {schedule.next_run}")
            print(f"      Enabled: {schedule.enabled}")
        
        # Summary
        print(f"\nComprehensive Vulnerability Management Summary:")
        print(f"  Schedules Created: {len(schedules)}")
        print(f"  Scans Executed: {len(completed_scans)}")
        print(f"  Vulnerabilities Found: {len(all_vulnerabilities)}")
        print(f"  Critical Vulnerabilities: {len(critical_vulnerabilities)}")
        print(f"  Open Vulnerabilities: {len(open_vulnerabilities)}")
        print(f"  âœ“ Comprehensive vulnerability management completed!")
        
        return {
            "schedules": schedules,
            "scans": completed_scans,
            "vulnerabilities": all_vulnerabilities
        }
    
    except Exception as e:
        print(f"Error in comprehensive vulnerability management: {e}")
        return None

# Run comprehensive vulnerability management example
comprehensive_vulnerability_management_example()
```

### **Vulnerability Scanning Schedule Example**
```python
from security.vulnerability_management import create_vulnerability_management_system, ScanType, ScheduleType

# Create vulnerability management system
vuln_system = create_vulnerability_management_system(base_url="http://localhost:5000")

# Example vulnerability scanning schedule
def vulnerability_scanning_schedule_example():
    """Vulnerability scanning schedule example"""
    try:
        print("Creating comprehensive vulnerability scanning schedule...")
        
        # Create daily network scan schedule
        daily_network = vuln_system.create_vulnerability_schedule(
            name="Daily Network Vulnerability Scan",
            description="Daily network vulnerability scan for critical infrastructure",
            scan_type=ScanType.NETWORK,
            schedule_type=ScheduleType.DAILY,
            targets=["192.168.1.0/24", "10.0.0.0/8"],
            target_services=["ssh", "http", "https", "database"],
            scan_configuration={
                "scan_args": "-sV --script vuln",
                "timeout": 3600,
                "parallel_scans": 5
            },
            enabled=True,
            created_by="security-team"
        )
        
        if daily_network:
            print(f"Daily Network Schedule Results:")
            print(f"  Schedule ID: {daily_network.schedule_id}")
            print(f"  Name: {daily_network.name}")
            print(f"  Scan Type: {daily_network.scan_type.value}")
            print(f"  Schedule Type: {daily_network.schedule_type.value}")
            print(f"  Next Run: {daily_network.next_run}")
            print(f"  Enabled: {daily_network.enabled}")
            print(f"  Targets: {len(daily_network.target_systems)}")
            print(f"  âœ“ Daily network schedule created successfully!")
        
        # Create weekly web application scan schedule
        weekly_web = vuln_system.create_vulnerability_schedule(
            name="Weekly Web Application Vulnerability Scan",
            description="Weekly web application vulnerability scan for production applications",
            scan_type=ScanType.WEB_APPLICATION,
            schedule_type=ScheduleType.WEEKLY,
            targets=["https://app1.company.com", "https://app2.company.com", "https://api.company.com"],
            target_services=["web_application"],
            scan_configuration={
                "scan_level": "medium",
                "timeout": 7200,
                "crawl_depth": 5,
                "scan_rules": ["sql_injection", "xss", "csrf", "authentication"]
            },
            enabled=True,
            created_by="security-team"
        )
        
        if weekly_web:
            print(f"\nWeekly Web Application Schedule Results:")
            print(f"  Schedule ID: {weekly_web.schedule_id}")
            print(f"  Name: {weekly_web.name}")
            print(f"  Scan Type: {weekly_web.scan_type.value}")
            print(f"  Schedule Type: {weekly_web.schedule_type.value}")
            print(f"  Next Run: {weekly_web.next_run}")
            print(f"  Enabled: {weekly_web.enabled}")
            print(f"  Targets: {len(weekly_web.target_systems)}")
            print(f"  âœ“ Weekly web application schedule created successfully!")
        
        # Create monthly dependency scan schedule
        monthly_dep = vuln_system.create_vulnerability_schedule(
            name="Monthly Dependency Vulnerability Scan",
            description="Monthly dependency vulnerability scan for all projects",
            scan_type=ScanType.DEPENDENCY,
            schedule_type=ScheduleType.MONTHLY,
            targets=[
                "/var/www/project1",
                "/var/www/project2",
                "/var/www/project3",
                "/opt/applications/project4"
            ],
            target_services=["python", "nodejs", "java", "ruby"],
            scan_configuration={
                "scan_python": True,
                "scan_nodejs": True,
                "scan_java": True,
                "scan_ruby": True,
                "update_database": True,
                "timeout": 1800
            },
            enabled=True,
            created_by="security-team"
        )
        
        if monthly_dep:
            print(f"\nMonthly Dependency Schedule Results:")
            print(f"  Schedule ID: {monthly_dep.schedule_id}")
            print(f"  Name: {monthly_dep.name}")
            print(f"  Scan Type: {monthly_dep.scan_type.value}")
            print(f"  Schedule Type: {monthly_dep.schedule_type.value}")
            print(f"  Next Run: {monthly_dep.next_run}")
            print(f"  Enabled: {monthly_dep.enabled}")
            print(f"  Targets: {len(monthly_dep.target_systems)}")
            print(f"  âœ“ Monthly dependency schedule created successfully!")
        
        # Create custom scan schedule (every 6 hours)
        custom_schedule = vuln_system.create_vulnerability_schedule(
            name="Critical Infrastructure Scan",
            description="Critical infrastructure vulnerability scan every 6 hours",
            scan_type=ScanType.COMPREHENSIVE,
            schedule_type=ScheduleType.CUSTOM,
            targets=["192.168.1.1", "192.168.1.2", "10.0.0.1"],
            target_services=["all"],
            schedule_config={
                "interval_hours": 6,
                "start_time": "00:00",
                "end_time": "23:59"
            },
            scan_configuration={
                "scan_network": True,
                "scan_web": True,
                "scan_dependencies": True,
                "scan_containers": True,
                "timeout": 5400,
                "parallel_scans": 3
            },
            enabled=True,
            created_by="security-team"
        )
        
        if custom_schedule:
            print(f"\nCustom Schedule Results:")
            print(f"  Schedule ID: {custom_schedule.schedule_id}")
            print(f"  Name: {custom_schedule.name}")
            print(f"  Scan Type: {custom_schedule.scan_type.value}")
            print(f"  Schedule Type: {custom_schedule.schedule_type.value}")
            print(f"  Interval: {custom_schedule.schedule_config.get('interval_hours')} hours")
            print(f"  Next Run: {custom_schedule.next_run}")
            print(f"  Enabled: {custom_schedule.enabled}")
            print(f"  âœ“ Custom schedule created successfully!")
        
        # Get all schedules
        all_schedules = vuln_system.get_schedules()
        
        print(f"\nVulnerability Scanning Schedule Summary:")
        print(f"  Total Schedules: {len(all_schedules)}")
        print(f"  Daily Schedules: {len([s for s in all_schedules if s.schedule_type == ScheduleType.DAILY])}")
        print(f"  Weekly Schedules: {len([s for s in all_schedules if s.schedule_type == ScheduleType.WEEKLY])}")
        print(f"  Monthly Schedules: {len([s for s in all_schedules if s.schedule_type == ScheduleType.MONTHLY])}")
        print(f"  Custom Schedules: {len([s for s in all_schedules if s.schedule_type == ScheduleType.CUSTOM])}")
        print(f"  Enabled Schedules: {len([s for s in all_schedules if s.enabled])}")
        print(f"  âœ“ Vulnerability scanning schedule completed!")
        
        return all_schedules
    
    except Exception as e:
        print(f"Error in vulnerability scanning schedule: {e}")
        return None

# Run vulnerability scanning schedule example
vulnerability_scanning_schedule_example()
```

## ðŸ”§ **Configuration**

### **Vulnerability Management Configuration**
```yaml
# vulnerability_management_config.yml
base_url: "http://localhost:5000"

vulnerability_management:
  enabled: true
  multi_scanner_support: true
  scheduled_scanning: true
  vulnerability_tracking: true
  scan_history: true
  automated_scanning: true
  
  scanners:
    nmap:
      enabled: true
      name: "Nmap Network Scanner"
      version: "1.0"
      scan_args: "-sV --script vuln"
      timeout: 3600
      parallel_scans: 5
    
    dependency:
      enabled: true
      name: "Dependency Vulnerability Scanner"
      version: "1.0"
      safety_api_key: ""
      scan_python: true
      scan_nodejs: true
      scan_java: true
      scan_ruby: true
      timeout: 1800
    
    web_application:
      enabled: true
      name: "Web Application Vulnerability Scanner"
      version: "1.0"
      zap_api_key: ""
      zap_url: "http://localhost:8080"
      scan_level: "medium"
      crawl_depth: 5
      timeout: 7200
    
    container:
      enabled: true
      name: "Container Vulnerability Scanner"
      version: "1.0"
      scan_images: true
      scan_registries: true
      timeout: 1800
    
    code:
      enabled: true
      name: "Code Vulnerability Scanner"
      version: "1.0"
      scan_static: true
      scan_dynamic: true
      timeout: 3600
    
    infrastructure:
      enabled: true
      name: "Infrastructure Vulnerability Scanner"
      version: "1.0"
      scan_cloud: true
      scan_on_premise: true
      timeout: 5400

schedules:
  enabled: true
  schedule_management: true
  automated_execution: true
  schedule_monitoring: true
  flexible_configuration: true
  
  schedule_types:
    daily: true
    weekly: true
    monthly: true
    custom: true
    on_demand: true
  
  default_schedules:
    daily_network:
      name: "Daily Network Vulnerability Scan"
      scan_type: "network"
      schedule_type: "daily"
      targets: ["192.168.1.0/24"]
      enabled: true
    
    weekly_web:
      name: "Weekly Web Application Vulnerability Scan"
      scan_type: "web_application"
      schedule_type: "weekly"
      targets: ["https://app.company.com"]
      enabled: true
    
    monthly_dependency:
      name: "Monthly Dependency Vulnerability Scan"
      scan_type: "dependency"
      schedule_type: "monthly"
      targets: ["/var/www/projects"]
      enabled: true

vulnerability_tracking:
  enabled: true
  vulnerability_database: true
  severity_classification: true
  remediation_tracking: true
  risk_scoring: true
  false_positive_management: true
  
  severity_levels:
    - "critical"
    - "high"
    - "medium"
    - "low"
    - "info"
  
  remediation_statuses:
    - "open"
    - "in_progress"
    - "resolved"
    - "false_positive"
    - "accepted_risk"
  
  risk_scoring:
    enabled: true
    cvss_scoring: true
    custom_scoring: true
    risk_calculation: true

scan_types:
  enabled: true
  network_scans: true
  web_application_scans: true
  container_scans: true
  dependency_scans: true
  code_scans: true
  infrastructure_scans: true
  comprehensive_scans: true
  
  scan_configurations:
    network:
      scan_args: "-sV --script vuln"
      timeout: 3600
      parallel_scans: 5
    
    web_application:
      scan_level: "medium"
      timeout: 7200
      crawl_depth: 5
    
    dependency:
      scan_python: true
      scan_nodejs: true
      timeout: 1800
    
    container:
      scan_images: true
      scan_registries: true
      timeout: 1800
    
    code:
      scan_static: true
      scan_dynamic: true
      timeout: 3600
    
    infrastructure:
      scan_cloud: true
      scan_on_premise: true
      timeout: 5400
    
    comprehensive:
      scan_network: true
      scan_web: true
      scan_dependencies: true
      scan_containers: true
      timeout: 7200

scheduler:
  enabled: true
  background_scheduler: true
  schedule_execution: true
  schedule_monitoring: true
  
  execution:
    check_interval: 60  # seconds
    max_concurrent_scans: 5
    retry_failed_scans: true
    max_retries: 3
  
  monitoring:
    scan_status_monitoring: true
    schedule_status_monitoring: true
    performance_monitoring: true
    error_monitoring: true

database:
  enabled: true
  vulnerability_database: true
  scan_database: true
  schedule_database: true
  
  storage:
    database_path: "/var/lib/mingus/vulnerability_management.db"
    backup_enabled: true
    retention_period: 365  # days
  
  tables:
    vulnerabilities: true
    vulnerability_scans: true
    vulnerability_schedules: true

security:
  enabled: true
  access_control: true
  audit_logging: true
  encryption: true
  
  permissions:
    read: ["security-team", "management"]
    write: ["security-team"]
    execute: ["security-team"]
    schedule: ["security-team"]

monitoring:
  enabled: true
  scan_monitoring: true
  schedule_monitoring: true
  vulnerability_monitoring: true
  
  metrics:
    scans_executed: true
    vulnerabilities_found: true
    schedules_active: true
    scan_success_rate: true

alerting:
  enabled: true
  scan_alerts: true
  vulnerability_alerts: true
  schedule_alerts: true
  
  channels:
    email: true
    slack: true
    sms: true
    webhook: true
```

## ðŸ”§ **Troubleshooting**

### **Common Issues**

#### **Scanner Issues**
```bash
# Check vulnerability management configuration
cat security/vulnerability_management_config.yml

# Verify scanner installations
which nmap
which safety
which npm
which zap

# Check scanner permissions
ls -la /usr/bin/nmap
ls -la /usr/local/bin/safety
ls -la /usr/bin/npm
```

#### **Schedule Issues**
```bash
# Check vulnerability management configuration
cat security/vulnerability_management_config.yml

# Verify schedule database
sqlite3 /var/lib/mingus/vulnerability_management.db ".tables"
sqlite3 /var/lib/mingus/vulnerability_management.db "SELECT * FROM vulnerability_schedules LIMIT 5;"

# Check scheduler status
ps aux | grep vulnerability_management
```

#### **Database Issues**
```bash
# Check vulnerability management configuration
cat security/vulnerability_management_config.yml

# Verify database permissions
ls -la /var/lib/mingus/vulnerability_management.db

# Check database integrity
sqlite3 /var/lib/mingus/vulnerability_management.db "PRAGMA integrity_check;"
```

### **Performance Optimization**

#### **Vulnerability Management Performance**
```python
# Optimize vulnerability management performance
vulnerability_optimization = {
    "scanner_caching": True,
    "parallel_scanning": True,
    "database_optimization": True,
    "result_caching": True,
    "schedule_optimization": True
}
```

#### **Scanner Performance**
```python
# Optimize scanner performance
scanner_optimization = {
    "nmap_optimization": True,
    "dependency_optimization": True,
    "web_application_optimization": True,
    "container_optimization": True,
    "code_optimization": True
}
```

## ðŸ“š **Additional Resources**

### **Documentation**
- [Nmap Documentation](https://nmap.org/docs.html)
- [OWASP ZAP Documentation](https://www.zaproxy.org/docs/)
- [Safety Documentation](https://pyup.io/safety/)
- [NPM Audit Documentation](https://docs.npmjs.com/cli/v8/commands/npm-audit)
- [Trivy Documentation](https://aquasecurity.github.io/trivy/)

### **Tools**
- [Nmap](https://nmap.org/)
- [OWASP ZAP](https://www.zaproxy.org/)
- [Safety](https://pyup.io/safety/)
- [Trivy](https://aquasecurity.github.io/trivy/)
- [Snyk](https://snyk.io/)
- [Bandit](https://bandit.readthedocs.io/)

### **Standards**
- [CVSS](https://www.first.org/cvss/)
- [CVE](https://cve.mitre.org/)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework)

## ðŸŽ¯ **Vulnerability Management Benefits**

### **Comprehensive Scanning**
- **Multi-Scanner Support**: Network, web application, container, dependency, code, infrastructure scanners
- **Scheduled Scanning**: Daily, weekly, monthly, custom, on-demand scanning schedules
- **Vulnerability Tracking**: Comprehensive vulnerability tracking and remediation management
- **Scan History**: Complete scan history and results tracking
- **Automated Scanning**: Automated vulnerability scanning based on schedules

### **Automated Management**
- **Schedule Management**: Create, update, enable/disable schedules
- **Automated Execution**: Automated schedule execution with background scheduler
- **Schedule Monitoring**: Monitor schedule execution and results
- **Flexible Configuration**: Configurable scan targets, types, and parameters

### **Vulnerability Tracking**
- **Vulnerability Database**: Comprehensive vulnerability database with metadata
- **Severity Classification**: Critical, high, medium, low, info severity levels
- **Remediation Tracking**: Track vulnerability remediation status and progress
- **Risk Scoring**: Calculate and track vulnerability risk scores
- **False Positive Management**: Mark and manage false positive vulnerabilities

### **Operational Efficiency**
- **Automated Scanning**: Automated vulnerability scanning based on schedules
- **Reduced Manual Work**: Reduction in manual vulnerability scanning tasks
- **Faster Detection**: Faster vulnerability detection and reporting
- **Better Visibility**: Better visibility into vulnerability status and trends

## ðŸ”„ **Updates and Maintenance**

### **Vulnerability Management Maintenance**

1. **Regular Updates**
   - Update vulnerability databases daily
   - Update scanner tools weekly
   - Update scan configurations monthly
   - Update vulnerability policies quarterly

2. **System Validation**
   - Validate scanner effectiveness regularly
   - Validate schedule execution effectiveness
   - Review vulnerability detection rates
   - Update vulnerability management standards

3. **Performance Monitoring**
   - Monitor scanner performance
   - Track schedule execution rates
   - Analyze vulnerability detection times
   - Optimize vulnerability management efficiency

### **Continuous Improvement**

1. **System Enhancement**
   - Add new scanner types
   - Enhance schedule capabilities
   - Improve vulnerability tracking
   - Add new vulnerability management features

2. **Integration Enhancement**
   - Add new vulnerability tools
   - Enhance scanning capabilities
   - Improve reporting systems
   - Add new automation tools

3. **Training and Awareness**
   - Regular team training
   - Vulnerability management procedure training
   - Scanner tool training
   - Schedule management training

---

*This comprehensive vulnerability management system guide ensures that MINGUS provides robust vulnerability management with comprehensive scanning schedules and reliable vulnerability tracking capabilities for all security vulnerabilities.* 