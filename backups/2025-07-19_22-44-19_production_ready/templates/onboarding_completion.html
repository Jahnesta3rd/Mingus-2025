<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="touch_target_optimization.css">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Mingus! - Onboarding Complete</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .celebration-animation {
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }
        .floating-element {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 to-pink-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Congratulations Screen -->
        <div id="congratulations-screen" class="max-w-4xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden">
            <!-- Header with celebration animation -->
            <div class="gradient-bg text-white p-8 text-center relative overflow-hidden">
                <div class="absolute inset-0 bg-black opacity-10"></div>
                <div class="relative z-10">
                    <div class="text-8xl mb-6 celebration-animation">üéâ</div>
                    <h1 class="text-4xl font-bold mb-4">
                        Welcome to the Mingus Community!
                    </h1>
                    <p class="text-xl opacity-90">
                        You've successfully completed your financial wellness setup
                    </p>
                </div>
                
                <!-- Floating celebration elements -->
                <div class="absolute top-4 left-4 text-2xl floating-element">‚ú®</div>
                <div class="absolute top-8 right-8 text-3xl floating-element" style="animation-delay: 0.5s;">üåü</div>
                <div class="absolute bottom-4 left-8 text-2xl floating-element" style="animation-delay: 1s;">üí´</div>
                <div class="absolute bottom-8 right-4 text-3xl floating-element" style="animation-delay: 1.5s;">üéä</div>
            </div>

            <div class="p-8">
                <!-- Empowerment Message -->
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">
                        You're Now Empowered to Transform Your Financial Future
                    </h2>
                    <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                        You've taken the first step toward financial wellness. Your personalized dashboard, 
                        insights, and community support are ready to help you achieve your goals.
                    </p>
                </div>

                <!-- Achievement Summary -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-green-50 border border-green-200 rounded-xl p-6 text-center">
                        <div class="text-3xl mb-2">‚úÖ</div>
                        <h3 class="font-semibold text-green-800 mb-1">Profile Complete</h3>
                        <p class="text-sm text-green-700" id="profile-completion">
                            100% of your profile is set up
                        </p>
                    </div>
                    
                    <div class="bg-blue-50 border border-blue-200 rounded-xl p-6 text-center">
                        <div class="text-3xl mb-2">üéØ</div>
                        <h3 class="font-semibold text-blue-800 mb-1">Goals Set</h3>
                        <p class="text-sm text-blue-700" id="goals-count">
                            3 financial goals configured
                        </p>
                    </div>
                    
                    <div class="bg-purple-50 border border-purple-200 rounded-xl p-6 text-center">
                        <div class="text-3xl mb-2">üí°</div>
                        <h3 class="font-semibold text-purple-800 mb-1">Insights Active</h3>
                        <p class="text-sm text-purple-700">
                            Personalized recommendations ready
                        </p>
                    </div>
                </div>

                <!-- Community Celebration -->
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-6 mb-8">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-xl font-bold text-gray-900 mb-2" id="community-title">
                                Join 15,420+ Members
                            </h3>
                            <p class="text-gray-600 mb-4" id="community-description">
                                You're now part of a community of 8,234 active members this week, 
                                with an average savings of $247.
                            </p>
                            <div class="flex items-center space-x-4 text-sm text-gray-500">
                                <span id="total-members">üë• 15,420 total members</span>
                                <span id="active-members">üî• 8,234 active this week</span>
                                <span id="avg-savings">üí∞ $247 average savings</span>
                            </div>
                        </div>
                        <div class="text-4xl">ü§ù</div>
                    </div>
                </div>

                <!-- First Check-in Invitation -->
                <div class="bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-xl p-6 mb-8">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-xl font-bold text-gray-900 mb-2">
                                Ready for Your First Weekly Check-in?
                            </h3>
                            <p class="text-gray-600 mb-4">
                                Set up your first wellness check-in reminder to start building healthy financial habits.
                                It only takes 2 minutes and helps you track your progress.
                            </p>
                            <div class="flex items-center space-x-2 text-sm text-gray-500">
                                <span>‚è∞ Takes 2 minutes</span>
                                <span>üìä Track your progress</span>
                                <span>üéØ Build healthy habits</span>
                            </div>
                        </div>
                        <div class="text-4xl">üìÖ</div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button
                        id="schedule-checkin-btn"
                        class="flex-1 bg-gradient-to-r from-green-600 to-blue-600 text-white font-semibold py-4 px-8 rounded-xl hover:from-green-700 hover:to-blue-700 transition-all duration-300 transform hover:scale-105"
                    >
                        Schedule My First Check-in
                    </button>
                    
                    <button
                        id="go-dashboard-btn"
                        class="flex-1 bg-gray-100 text-gray-700 font-semibold py-4 px-8 rounded-xl hover:bg-gray-200 transition-all duration-300"
                    >
                        Go to Dashboard
                    </button>
                </div>
            </div>
        </div>

        <!-- Engagement Setup Screen (Hidden by default) -->
        <div id="engagement-screen" class="max-w-4xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden hidden">
            <!-- Header -->
            <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-8 text-center">
                <div class="text-6xl mb-4">üöÄ</div>
                <h1 class="text-3xl font-bold mb-2">
                    Set Up Your Ongoing Engagement
                </h1>
                <p class="text-xl opacity-90">
                    Customize your experience and stay connected
                </p>
            </div>

            <div class="p-8">
                <!-- Check-in Reminder Setup -->
                <div class="mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">
                        Weekly Check-in Reminders
                    </h2>
                    
                    <div class="bg-gray-50 rounded-xl p-6 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">Enable Weekly Reminders</h3>
                                <p class="text-gray-600">Get gentle nudges to complete your wellness check-ins</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input
                                    type="checkbox"
                                    id="reminder-enabled"
                                    checked
                                    class="sr-only peer"
                                >
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>

                        <div id="reminder-settings" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Frequency</label>
                                <select id="reminder-frequency" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" class="form-input">
                                    <option value="weekly">Weekly</option>
                                    <option value="biweekly">Every 2 weeks</option>
                                    <option value="monthly">Monthly</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Day</label>
                                <select id="reminder-day" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" class="form-input">
                                    <option value="monday">Monday</option>
                                    <option value="tuesday">Tuesday</option>
                                    <option value="wednesday" selected>Wednesday</option>
                                    <option value="thursday">Thursday</option>
                                    <option value="friday">Friday</option>
                                    <option value="saturday">Saturday</option>
                                    <option value="sunday">Sunday</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Time</label>
                                <select id="reminder-time" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" class="form-input">
                                    <option value="09:00">9:00 AM</option>
                                    <option value="10:00" selected>10:00 AM</option>
                                    <option value="11:00">11:00 AM</option>
                                    <option value="12:00">12:00 PM</option>
                                    <option value="13:00">1:00 PM</option>
                                    <option value="14:00">2:00 PM</option>
                                    <option value="15:00">3:00 PM</option>
                                    <option value="16:00">4:00 PM</option>
                                    <option value="17:00">5:00 PM</option>
                                    <option value="18:00">6:00 PM</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Notification Preferences -->
                    <div class="bg-gray-50 rounded-xl p-6 mb-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Notification Preferences</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <input
                                    type="checkbox"
                                    id="email-notifications"
                                    checked
                                    class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                >
                                <span class="text-sm font-medium text-gray-900">Email Notifications</span>
                            </label>
                            
                            <label class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-100 cursor-pointer">
                                <input
                                    type="checkbox"
                                    id="push-notifications"
                                    checked
                                    class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                >
                                <span class="text-sm font-medium text-gray-900">Push Notifications</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Mobile App Download -->
                <div id="mobile-app-section" class="mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">
                        Get the Mobile App
                    </h2>
                    
                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="text-xl font-bold text-gray-900 mb-2">
                                    Take Mingus With You
                                </h3>
                                <p class="text-gray-600 mb-4">
                                    Download our mobile app for quick check-ins, real-time insights, and 
                                    notifications on the go. Available for iOS and Android.
                                </p>
                                <div class="flex items-center space-x-4 text-sm text-gray-500">
                                    <span>üì± Quick check-ins</span>
                                    <span>üîî Real-time notifications</span>
                                    <span>üìä Mobile insights</span>
                                </div>
                            </div>
                            <div class="text-6xl">üì±</div>
                        </div>
                        
                        <button
                            id="download-app-btn"
                            class="mt-4 w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-semibold py-3 px-6 rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all duration-300"
                        >
                            Download Mobile App
                        </button>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button
                        id="start-journey-btn"
                        class="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold py-4 px-8 rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105"
                    >
                        Start My Journey
                    </button>
                    
                    <button
                        id="back-summary-btn"
                        class="flex-1 bg-gray-100 text-gray-700 font-semibold py-4 px-8 rounded-xl hover:bg-gray-200 transition-all duration-300"
                    >
                        Back to Summary
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Get user data and populate the completion screen
        async function loadCompletionData() {
            try {
                const response = await fetch('/api/onboarding/completion/data/current', {
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${localStorage.getItem('token')}`
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    
                    // Update completion data
                    document.getElementById('profile-completion').textContent = 
                        `${data.profile_completion}% of your profile is set up`;
                    document.getElementById('goals-count').textContent = 
                        `${data.goals_count} financial goals configured`;
                    
                    // Update community stats
                    document.getElementById('community-title').textContent = 
                        `Join ${data.community_stats.total_members.toLocaleString()}+ Members`;
                    document.getElementById('community-description').textContent = 
                        `You're now part of a community of ${data.community_stats.active_this_week.toLocaleString()} active members this week, with an average savings of $${data.community_stats.average_savings}.`;
                    document.getElementById('total-members').textContent = 
                        `üë• ${data.community_stats.total_members.toLocaleString()} total members`;
                    document.getElementById('active-members').textContent = 
                        `üî• ${data.community_stats.active_this_week.toLocaleString()} active this week`;
                    document.getElementById('avg-savings').textContent = 
                        `üí∞ $${data.community_stats.average_savings} average savings`;
                    
                    // Hide mobile app section if not available
                    if (!data.mobile_app_available) {
                        document.getElementById('mobile-app-section').style.display = 'none';
                    }
                }
            } catch (error) {
                console.error('Failed to load completion data:', error);
            }
        }

        // Schedule first check-in
        async function scheduleFirstCheckin() {
            const enabled = document.getElementById('reminder-enabled').checked;
            const frequency = document.getElementById('reminder-frequency').value;
            const day = document.getElementById('reminder-day').value;
            const time = document.getElementById('reminder-time').value;
            const email = document.getElementById('email-notifications').checked;
            const push = document.getElementById('push-notifications').checked;

            const preferences = {
                enabled,
                frequency,
                day,
                time,
                email,
                push
            };

            try {
                const response = await fetch('/api/onboarding/completion/schedule-checkin', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${localStorage.getItem('token')}`
                    },
                    body: JSON.stringify({
                        user_id: 'current',
                        preferences
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    console.log('Check-in scheduled:', result);
                    showEngagementScreen();
                } else {
                    console.error('Failed to schedule check-in');
                }
            } catch (error) {
                console.error('Error scheduling check-in:', error);
            }
        }

        // Show engagement setup screen
        function showEngagementScreen() {
            document.getElementById('congratulations-screen').classList.add('hidden');
            document.getElementById('engagement-screen').classList.remove('hidden');
        }

        // Show congratulations screen
        function showCongratulationsScreen() {
            document.getElementById('engagement-screen').classList.add('hidden');
            document.getElementById('congratulations-screen').classList.remove('hidden');
        }

        // Download mobile app
        function downloadMobileApp() {
            const userAgent = navigator.userAgent.toLowerCase();
            if (/iphone|ipad|ipod/.test(userAgent)) {
                window.open('https://apps.apple.com/app/mingus-financial-wellness', '_blank');
            } else if (/android/.test(userAgent)) {
                window.open('https://play.google.com/store/apps/details?id=com.mingus.app', '_blank');
            } else {
                window.open('/mobile-app-download', '_blank');
            }
        }

        // Go to dashboard
        function goToDashboard() {
            window.location.href = '/dashboard';
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            loadCompletionData();

            // Button event listeners
            document.getElementById('schedule-checkin-btn').addEventListener('click', scheduleFirstCheckin);
            document.getElementById('go-dashboard-btn').addEventListener('click', goToDashboard);
            document.getElementById('start-journey-btn').addEventListener('click', goToDashboard);
            document.getElementById('back-summary-btn').addEventListener('click', showCongratulationsScreen);
            document.getElementById('download-app-btn').addEventListener('click', downloadMobileApp);

            // Toggle reminder settings visibility
            document.getElementById('reminder-enabled').addEventListener('change', function() {
                const settings = document.getElementById('reminder-settings');
                if (this.checked) {
                    settings.style.display = 'grid';
                } else {
                    settings.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html> 